{
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=funding_monitor;Username=postgres;Password=postgres"
  },
  "RabbitMQ": {
    "Host": "localhost",
    "Username": "guest",
    "Password": "guest",
    "Port": 5672
  },
  "RateLimit": {
    "Binance": {
      "PermitLimit": 1200,
      "WindowSeconds": 60,
      "SegmentsPerWindow": 12,
      "QueueLimit": 100
    },
    "Bybit": {
      "PermitLimit": 600,
      "WindowSeconds": 60,
      "SegmentsPerWindow": 6,
      "QueueLimit": 50
    }
  },
  "CurrentDataCollectionOptions": {
    "UpdateIntervalMinutes": 1,
    "CollectionTimeoutSeconds": 15
  },
  "HistoricalDataCollectionOptions": {
    "ApiPageSize": 200,
    "BatchSize": 5,
    "MaxHistoryMonths": 1
  },
  "NLog": {
    "throwConfigExceptions": true,
    "targets": {
      "file_all": {
        "type": "File",
        "fileName": "logs/${shortdate}/all.log",
        "layout": "${longdate}|${level:uppercase=true}|${logger}|${message} ${exception:format=ToString}",
        "archiveFileName": "logs/archive/all.{#}.log",
        "archiveEvery": "Day",
        "archiveNumbering": "Rolling",
        "maxArchiveFiles": 7
      },
      "file_current": {
        "type": "File",
        "fileName": "logs/${shortdate}/current_rates.log",
        "layout": "${longdate}|${message}",
        "archiveFileName": "logs/archive/current_rates.{#}.log",
        "archiveEvery": "Day",
        "archiveNumbering": "Rolling",
        "maxArchiveFiles": 7
      },
      "file_historical": {
        "type": "File",
        "fileName": "logs/${shortdate}/historical.log",
        "layout": "${longdate}|${message}",
        "archiveFileName": "logs/archive/historical.{#}.log",
        "archiveEvery": "Day",
        "archiveNumbering": "Rolling",
        "maxArchiveFiles": 7
      },
      "file_api": {
        "type": "File",
        "fileName": "logs/${shortdate}/api.log",
        "layout": "${longdate}|${level:uppercase=true}|${message} ${exception:format=ToString}",
        "archiveFileName": "logs/archive/api.{#}.log",
        "archiveEvery": "Day",
        "archiveNumbering": "Rolling",
        "maxArchiveFiles": 7
      },
      "file_health": {
        "type": "File",
        "fileName": "logs/${shortdate}/health.log",
        "layout": "${longdate}|${message}",
        "archiveFileName": "logs/archive/health.{#}.log",
        "archiveEvery": "Day",
        "archiveNumbering": "Rolling",
        "maxArchiveFiles": 7
      },
      "file_events": {
        "type": "File",
        "fileName": "logs/${shortdate}/events.log",
        "layout": "${longdate}|${level:uppercase=true}|${message}",
        "archiveFileName": "logs/archive/events.{#}.log",
        "archiveEvery": "Day",
        "archiveNumbering": "Rolling",
        "maxArchiveFiles": 7
      },
      "file_database": {
        "type": "File",
        "fileName": "logs/${shortdate}/database.log",
        "layout": "${longdate}|${level:uppercase=true}|${logger}|${message} ${exception:format=ToString}",
        "archiveFileName": "logs/archive/database.{#}.log",
        "archiveEvery": "Day",
        "archiveNumbering": "Rolling",
        "maxArchiveFiles": 7
      },
      "file_errors": {
        "type": "File",
        "fileName": "logs/${shortdate}/errors.log",
        "layout": "${longdate}|${level:uppercase=true}|${logger}|${message} ${exception:format=ToString,StackTrace}",
        "archiveFileName": "logs/archive/errors.{#}.log",
        "archiveEvery": "Day",
        "archiveNumbering": "Rolling",
        "maxArchiveFiles": 30
      }
    },
    "rules": [
      {
        "logger": "*",
        "minLevel": "Info",
        "maxLevel": "Fatal",
        "writeTo": "file_all"
      },
      {
        "logger": "*",
        "minLevel": "Error",
        "maxLevel": "Fatal",
        "writeTo": "file_errors"
      },
      {
        "logger": "FundingMonitor.Application.Services.CurrentDataCollector",
        "minLevel": "Info",
        "writeTo": "file_current"
      },
      {
        "logger": "FundingMonitor.Application.Services.HistoricalDataEventConsumer",
        "minLevel": "Info",
        "writeTo": "file_historical"
      },
      {
        "logger": "FundingMonitor.Infrastructure.ExchangeClients.*",
        "minLevel": "Info",
        "writeTo": "file_api"
      },
      {
        "logger": "FundingMonitor.Console.Services.RabbitMqConsumer",
        "minLevel": "Info",
        "writeTo": "file_events"
      },
      {
        "logger": "FundingMonitor.Console.Services.CurrentDataBackgroundService",
        "minLevel": "Info",
        "writeTo": "file_current"
      },
      {
        "logger": "FundingMonitor.Infrastructure.Events.*",
        "minLevel": "Debug",
        "writeTo": "file_events"
      },
      {
        "logger": "FundingMonitor.Infrastructure.State.*",
        "minLevel": "Debug",
        "writeTo": "file_health"
      },
      {
        "logger": "FundingMonitor.Infrastructure.Data.*",
        "minLevel": "Debug",
        "writeTo": "file_database"
      },
      {
        "logger": "Microsoft.EntityFrameworkCore.*",
        "minLevel": "Warning",
        "writeTo": "file_database"
      },
      {
        "logger": "Microsoft.EntityFrameworkCore.Database.Command",
        "minLevel": "Warning",
        "writeTo": "file_database"
      }
    ]
  }
}